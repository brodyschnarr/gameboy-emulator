<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset=9000001"UTF-8">
    <meta name="viewport" content=9000001"width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content=9000001"no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content=9000001"no-cache">
    <meta http-equiv="Expires" content=9000001"0">
    <meta name="description" content=9000001"Canadian retirement calculator with regional data and tax-aware projections">
    <title>Retirement Planner V4 | Visual Canadian Calculator</title>
    <link rel="stylesheet" href="style.css?v=12&t=9000001">
</head>
<body>
    
    <header class="header">
        <div class="container">
            <a href="hub.html" class="back-link">‚Üê Back to Hub</a>
            <h1>üí∞ Retirement Planner V4</h1>
            <p class="tagline">Visual, regional, tax-aware Canadian retirement planning</p>
        </div>
    </header>

    <!-- Money Music Button -->
    <button id="money-music-btn" class="money-music-btn" aria-label="Toggle music player">
        <span class="music-icon">üí∏</span>
        <span class="music-text">Make It Rain</span>
    </button>
    
    <!-- Mini Music Player (slides in when activated) -->
    <div id="music-player" class="music-player hidden">
        <div class="music-player-header">
            <span>üéµ Loading music...</span>
            <button id="close-music" class="close-music-btn">‚úï</button>
        </div>
        <iframe 
            id="youtube-iframe"
            width="100%" 
            height="152" 
            src="" 
            frameborder="0" 
            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
            loading="lazy">
        </iframe>
    </div>

    <main class="container">

        <!-- Progress Indicator -->
        <div class="progress-indicator" id="progress-indicator">
            <div class="progress-step active" data-step="basic">
                <div class="step-number">1</div>
                <div class="step-label">Basic Info</div>
            </div>
            <div class="progress-step" data-step="savings">
                <div class="step-number">2</div>
                <div class="step-label">Savings</div>
            </div>
            <div class="progress-step" data-step="contributions">
                <div class="step-number">3</div>
                <div class="step-label">Contributions</div>
            </div>
            <div class="progress-step" data-step="retirement">
                <div class="step-number">4</div>
                <div class="step-label">Retirement</div>
            </div>
            <div class="progress-step" data-step="healthcare">
                <div class="step-number">5</div>
                <div class="step-label">Healthcare</div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             STEP 1: Basic Info + Location
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="card" id="step-basic">
            <h2>üìç Step 1 of 5: Start Here</h2>
            
            <!-- Family Status -->
            <div class="input-group">
                <label>Planning for...</label>
                <div class="toggle-buttons">
                    <button type="button" class="toggle-btn active" data-family="single" id="family-single">
                        üë§ Just Me
                    </button>
                    <button type="button" class="toggle-btn" data-family="couple" id="family-couple">
                        üë´ Me + Partner
                    </button>
                </div>
                <small class="input-hint">Affects income inputs and government benefits</small>
            </div>

            <!-- Age(s) -->
            <div class="input-group">
                <label for="current-age">Your Age</label>
                <input type="number" id="current-age" placeholder="35" min="18" max="100" required>
            </div>

            <div class="input-group hidden" id="partner-age-group">
                <label for="partner-age">Partner's Age</label>
                <input type="number" id="partner-age" placeholder="35" min="18" max="100">
            </div>

            <!-- Location (Map) -->
            <div class="input-group">
                <label>Where do you live?</label>
                <p class="section-intro">Click your province to see regional options (e.g., Toronto vs Northern Ontario)</p>
                
                <div id="region-display" class="region-display hidden">
                    <strong>üìç Selected Location:</strong> <span id="region-name"></span>
                </div>
                
                <div id="map-container"></div>
                <div id="region-picker-container" class="hidden"></div>
                <input type="hidden" id="province" value="">
                <input type="hidden" id="region" value="">
            </div>

            <!-- Income (changes based on family status) -->
            <div id="income-section-single">
                <div class="input-group">
                    <label for="current-income">
                        Annual Income
                        <button type="button" class="info-btn" data-tooltip="Used to estimate CPP benefits">?</button>
                    </label>
                    <div class="input-with-prefix">
                        <span class="prefix">$</span>
                        <input type="number" id="current-income" placeholder="75000" min="0" step="1000" required>
                    </div>
                    <small id="income-benchmark" class="benchmark-text"></small>
                </div>
            </div>

            <div id="income-section-couple" class="hidden">
                <div class="input-group">
                    <label for="income-person1">
                        Person 1 Income
                        <button type="button" class="info-btn" data-tooltip="Used for separate CPP calculation">?</button>
                    </label>
                    <div class="input-with-prefix">
                        <span class="prefix">$</span>
                        <input type="number" id="income-person1" placeholder="75000" min="0" step="1000">
                    </div>
                </div>

                <div class="input-group">
                    <label for="income-person2">
                        Person 2 Income
                        <button type="button" class="info-btn" data-tooltip="Used for separate CPP calculation">?</button>
                    </label>
                    <div class="input-with-prefix">
                        <span class="prefix">$</span>
                        <input type="number" id="income-person2" placeholder="65000" min="0" step="1000">
                    </div>
                </div>

                <div class="total-display">
                    <strong>Total Household Income:</strong> <span id="household-income-display">$0</span>
                </div>
                
                <div id="household-income-benchmark" class="benchmark-display hidden">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- Additional Income Sources -->
            <div class="input-group">
                <h3>Additional Income Sources</h3>
                <p class="section-intro">Pension, annuity, rental income, etc.</p>
                <div id="income-sources-list"></div>
                <button type="button" class="btn-secondary" id="btn-add-income-source">+ Add Income Source</button>
            </div>

            <button type="button" class="btn-primary" id="btn-next-savings">
                Continue to Savings ‚Üí
            </button>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             STEP 2: Savings
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="card hidden" id="step-savings">
            <h2>üíµ Step 2 of 5: Current Savings</h2>
            <p class="section-intro">How much have you saved for retirement so far?</p>
            <p id="savings-benchmark" class="benchmark-highlight"></p>

            <div class="input-group">
                <label for="rrsp">RRSP</label>
                <div class="input-with-prefix">
                    <span class="prefix">$</span>
                    <input type="number" id="rrsp" placeholder="0" min="0" step="1000">
                </div>
                <small class="input-hint">Tax-deferred until retirement</small>
            </div>

            <div class="input-group">
                <label for="tfsa">TFSA</label>
                <div class="input-with-prefix">
                    <span class="prefix">$</span>
                    <input type="number" id="tfsa" placeholder="0" min="0" step="1000">
                </div>
                <small class="input-hint">Tax-free forever üéâ</small>
            </div>

            <div class="input-group">
                <label for="nonreg">Non-Registered</label>
                <div class="input-with-prefix">
                    <span class="prefix">$</span>
                    <input type="number" id="nonreg" placeholder="0" min="0" step="1000">
                </div>
                <small class="input-hint">Capital gains taxed at 50%</small>
            </div>

            <div class="input-group">
                <label for="other">Other Investments</label>
                <div class="input-with-prefix">
                    <span class="prefix">$</span>
                    <input type="number" id="other" placeholder="0" min="0" step="1000">
                </div>
            </div>

            <div class="total-display">
                <strong>Total Savings:</strong> <span id="total-savings-display">$0</span>
                <span id="total-savings-benchmark" class="benchmark-text"></span>
            </div>

            <button type="button" class="btn-secondary" id="btn-back-basic">‚Üê Back</button>
            <button type="button" class="btn-primary" id="btn-next-contributions">Continue ‚Üí</button>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             STEP 3: Contributions
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="card hidden" id="step-contributions">
            <h2>üìà Step 3 of 5: Monthly Contributions</h2>

            <div class="input-group">
                <label for="monthly-contribution">Monthly Contribution</label>
                <div class="input-with-prefix">
                    <span class="prefix">$</span>
                    <input type="number" id="monthly-contribution" placeholder="500" min="0" step="50">
                </div>
                <small id="contribution-benchmark" class="benchmark-text"></small>
            </div>

            <div class="input-group">
                <label>Split</label>
                <div class="split-inputs">
                    <div>
                        <label for="split-rrsp">RRSP %</label>
                        <input type="number" id="split-rrsp" placeholder="60" min="0" max="100" value="60">
                    </div>
                    <div>
                        <label for="split-tfsa">TFSA %</label>
                        <input type="number" id="split-tfsa" placeholder="40" min="0" max="100" value="40">
                    </div>
                    <div>
                        <label for="split-nonreg">Non-Reg %</label>
                        <input type="number" id="split-nonreg" placeholder="0" min="0" max="100" value="0">
                    </div>
                </div>
                <small id="split-total" class="input-hint"></small>
            </div>

            <button type="button" class="btn-secondary" id="btn-back-savings">‚Üê Back</button>
            <button type="button" class="btn-primary" id="btn-next-retirement">Continue ‚Üí</button>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             STEP 4: Retirement Plan
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="card hidden" id="step-retirement">
            <h2>üèñÔ∏è Step 4 of 5: Retirement Plan</h2>

            <div class="input-group">
                <label for="retirement-age">Retirement Age</label>
                <input type="number" id="retirement-age" placeholder="65" min="50" max="80" value="65">
            </div>

            <div class="input-group">
                <label for="life-expectancy">Life Expectancy</label>
                <input type="number" id="life-expectancy" placeholder="90" min="65" max="110" value="90">
            </div>

            <!-- CPP Start Age Optimizer -->
            <div class="input-group">
                <label>
                    When to start CPP?
                    <button type="button" class="info-btn" data-tooltip="Starting CPP early means lower payments for life. Starting late means higher payments.">?</button>
                </label>
                <div class="cpp-optimizer">
                    <div class="slider-container">
                        <input type="range" id="cpp-start-age" min="60" max="70" value="65" step="1">
                        <div class="slider-labels">
                            <span>60</span>
                            <span>65</span>
                            <span>70</span>
                        </div>
                    </div>
                    <div class="cpp-preview">
                        <div class="cpp-age-display">Age: <strong id="cpp-age-value">65</strong></div>
                        <div class="cpp-amount-display">Estimated: <strong id="cpp-amount-value">$0/year</strong></div>
                        <div class="cpp-lifetime-display">Lifetime total: <strong id="cpp-lifetime-value">$0</strong></div>
                    </div>
                    <button type="button" class="btn-link" id="btn-cpp-details">See detailed comparison ‚Üí</button>
                </div>
            </div>

            <!-- Lifestyle -->
            <div class="input-group">
                <label>Annual Spending</label>
                <div class="lifestyle-presets">
                    <button type="button" class="preset-btn" data-lifestyle="modest" data-amount=9000001"35000">
                        <div class="preset-name">Modest</div>
                        <div class="preset-amount">$35K</div>
                    </button>
                    <button type="button" class="preset-btn" data-lifestyle="average" data-amount=9000001"48000">
                        <div class="preset-name">Avg</div>
                        <div class="preset-amount">$48K</div>
                    </button>
                    <button type="button" class="preset-btn" data-lifestyle="comfortable" data-amount=9000001"62000">
                        <div class="preset-name">Comfortable</div>
                        <div class="preset-amount">$62K</div>
                    </button>
                    <button type="button" class="preset-btn" data-lifestyle="affluent" data-amount=9000001"95000">
                        <div class="preset-name">Affluent</div>
                        <div class="preset-amount">$95K</div>
                    </button>
                    <button type="button" class="preset-btn" data-lifestyle="ultrawealthy" data-amount=9000001"150000">
                        <div class="preset-name">Ultra-Wealthy</div>
                        <div class="preset-amount">$150K</div>
                    </button>
                </div>

                <div id="lifestyle-detail" class="lifestyle-detail hidden">
                    <div class="lifestyle-header">
                        <h3 id="lifestyle-detail-title"></h3>
                        <p id="lifestyle-detail-tagline"></p>
                    </div>
                    <div class="breakdown-grid" id="lifestyle-breakdown"></div>
                    <div class="examples-section">
                        <h4>What this looks like:</h4>
                        <ul id="lifestyle-examples"></ul>
                    </div>
                    <button type="button" class="btn-close-detail" id="close-detail">Close</button>
                </div>
            </div>

            <div class="input-group">
                <label for="annual-spending">Or Custom Amount</label>
                <div class="input-with-prefix">
                    <span class="prefix">$</span>
                    <input type="number" id="annual-spending" placeholder="60000" min="0" step="1000">
                </div>
                <small id="spending-recommendation" class="benchmark-text"></small>
            </div>

            <button type="button" class="btn-secondary" id="btn-back-contributions">‚Üê Back</button>
            <button type="button" class="btn-primary" id="btn-next-healthcare">Continue ‚Üí</button>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             STEP 5: Healthcare & Debt
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section class="card hidden" id="step-healthcare">
            <h2>üè• Step 5 of 5: Healthcare <h2>üè• Healthcare & Debt</h2> Debt</h2>

            <!-- Healthcare -->
            <div class="input-group">
                <label>Healthcare Costs</label>
                <p class="section-intro">Often overlooked but important</p>
                <div class="health-status-selector">
                    <button type="button" class="health-btn active" data-health="average">Average Health</button>
                    <button type="button" class="health-btn" data-health="excellent">Excellent Health</button>
                    <button type="button" class="health-btn" data-health="fair">Fair Health</button>
                </div>
                <div class="healthcare-preview" id="healthcare-preview">
                    <div class="preview-line">
                        <span>Estimated annual cost:</span>
                        <span id="healthcare-annual">$0</span>
                    </div>
                    <div class="preview-line">
                        <span>Total over retirement:</span>
                        <span id="healthcare-total">$0</span>
                    </div>
                </div>
            </div>

            <!-- Debt -->
            <div class="input-group">
                <label>Current Debt</label>
                <div class="input-with-prefix">
                    <span class="prefix">$</span>
                    <input type="number" id="current-debt" placeholder="0" min="0" step="1000">
                </div>
                <small class="input-hint">Mortgage, loans, etc. (not credit cards)</small>
            </div>

            <div class="input-group hidden" id="debt-payoff-group">
                <label for="debt-payoff-age">Plan to pay off by age:</label>
                <input type="number" id="debt-payoff-age" placeholder="65" min="0" max="100">
            </div>

            <button type="button" class="btn-secondary" id="btn-back-retirement">‚Üê Back</button>
            <button type="button" class="btn-primary" id="btn-calculate">Calculate My Plan üöÄ</button>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             RESULTS
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="results" class="hidden">
            
            <!-- Scenario Tabs -->
            <div class="scenario-tabs" id="scenario-tabs">
                <button class="scenario-tab active" data-scenario="base">Your Plan</button>
                <button class="scenario-tab" data-scenario="retire5early">Retire 5 Years Earlier</button>
                <button class="scenario-tab" data-scenario="retire5late">Retire 5 Years Later</button>
                <button class="scenario-tab" data-scenario="spend20less">Spend 20% Less</button>
                <button class="scenario-tab" data-scenario="spend20more">Spend 20% More</button>
            </div>

            <div id="status-banner" class="card status-banner"></div>

            <!-- Quick Stats -->
            <section class="card">
                <h2>üìä Your Retirement Snapshot</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Portfolio at Retirement</div>
                        <div class="stat-value" id="stat-portfolio">$0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Annual Income</div>
                        <div class="stat-value" id="stat-income">$0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Money Lasts Until</div>
                        <div class="stat-value" id="stat-lasts">Age 0</div>
                        <small id="stat-lasts-note"></small>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Probability of Success</div>
                        <div class="stat-value" id="stat-probability">0%</div>
                        <small id="stat-probability-note"></small>
                    </div>
                </div>
            </section>

            <!-- Charts -->
            <section class="card">
                <h2>üìà Portfolio Projection</h2>
                <canvas id="projection-chart"></canvas>
            </section>

            <section class="card">
                <h2>üìÖ Year-by-Year Breakdown</h2>
                <div id="year-breakdown-chart"></div>
            </section>

            <!-- Legacy View -->
            <section class="card">
                <h2>üéÅ Legacy / Estate</h2>
                <div id="legacy-content">
                    <div class="legacy-display">
                        <div class="legacy-amount" id="legacy-amount">$0</div>
                        <p class="legacy-description" id="legacy-description"></p>
                    </div>
                </div>
            </section>

            <!-- Tax & Withdrawal -->
            <section class="card">
                <h2>üîç Tax & Withdrawal Strategy</h2>
                <div id="breakdown-content"></div>
            </section>

            <!-- Scenario Comparison (now handled by tabs above) -->
            <!-- Removed manual scenario section - use tabs instead -->

            <!-- Actions -->
            <div class="button-row">
                <button type="button" class="btn-secondary" id="btn-edit">‚úèÔ∏è Edit Inputs</button>
                <button type="button" class="btn-secondary" id="btn-save">üíæ Save</button>
            </div>
        </section>

        <!-- Advanced Assumptions -->
        <section class="card collapsible">
            <h2 class="collapsible-header" id="toggle-assumptions">
                ‚öôÔ∏è Advanced Assumptions <span class="toggle-icon">‚ñº</span>
            </h2>
            <div class="collapsible-content hidden" id="assumptions-content">
                <div class="input-group">
                    <label for="return-rate">Investment Return (%)</label>
                    <input type="number" id="return-rate" value="6" min="0" max="20" step="0.5">
                </div>
                <div class="input-group">
                    <label for="inflation-rate">Inflation Rate (%)</label>
                    <input type="number" id="inflation-rate" value="2.5" min="0" max="10" step="0.5">
                </div>
            </div>
        </section>

    </main>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         MODALS
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

    <!-- Income Source Modal -->
    <div id="income-source-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Add Income Source</h3>
            <form id="income-source-form">
                <div class="input-group">
                    <label for="income-source-type">Type</label>
                    <select id="income-source-type" required>
                        <option value="pension">Defined Benefit Pension</option>
                        <option value="annuity">Annuity</option>
                        <option value="rental">Rental Income</option>
                        <option value="partTime">Part-Time Work</option>
                        <option value="other">Other Income</option>
                    </select>
                    <small id="income-type-description" class="input-hint"></small>
                </div>

                <div class="input-group">
                    <label for="income-custom-name">Name (optional)</label>
                    <input type="text" id="income-custom-name" placeholder="e.g., Teacher's Pension">
                </div>

                <div class="input-group">
                    <label for="income-amount">Annual Amount</label>
                    <div class="input-with-prefix">
                        <span class="prefix">$</span>
                        <input type="number" id="income-amount" placeholder="12000" min="0" step="100" required>
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label for="income-start-age">Start Age</label>
                        <input type="number" id="income-start-age" placeholder="65" min="0" max="110" required>
                    </div>

                    <div class="input-group">
                        <label for="income-end-age">End Age (optional)</label>
                        <input type="number" id="income-end-age" placeholder="Lifetime" min="0" max="110">
                        <small class="input-hint">Leave blank for lifetime</small>
                    </div>
                </div>

                <div class="button-row">
                    <button type="button" class="btn-secondary" id="close-income-modal">Cancel</button>
                    <button type="submit" class="btn-primary">Add Income Source</button>
                </div>
            </form>
        </div>
    </div>

    <!-- CPP Details Modal -->
    <div id="cpp-details-modal" class="modal hidden">
        <div class="modal-content">
            <h3>CPP Start Age Comparison</h3>
            <div id="cpp-comparison-table"></div>
            <button type="button" class="btn-primary" id="close-cpp-modal">Close</button>
        </div>
    </div>

    <!-- Scenario Modal removed - now using auto-run tabs -->

    <!-- Scripts -->
    <script src="canada-tax.js?v=12&t=9000001"></script>
    <script src="cpp-calculator.js?v=12&t=9000001"></script>
    <script src="benchmarks.js?v=12&t=9000001"></script>
    <script src="lifestyle-data.js?v=12&t=9000001"></script>
    <script src="regional-data.js?v=12&t=9000001"></script>
    <script src="canada-map.js?v=12&t=9000001"></script>
    <script src="income-sources.js?v=12&t=9000001"></script>
    <script src="cpp-optimizer.js?v=12&t=9000001"></script>
    <script src="scenario-manager.js?v=12&t=9000001"></script>
    <script src="healthcare-estimator.js?v=12&t=9000001"></script>
    <script src="calc.js?v=12&t=9000001"></script>
    <script src="app.js?v=12&t=9000001"></script>
    
    <!-- Money Music Player -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('money-music-btn');
            const player = document.getElementById('music-player');
            const iframe = document.getElementById('youtube-iframe');
            const closeBtn = document.getElementById('close-music');
            
            // Make It Rain Remix - Fat Joe ft. Lil Wayne
            const spotifyTrackId = '3JWiUv4wsfZhdsPkcYigMI';
            
            btn.addEventListener('click', () => {
                if (player.classList.contains('hidden')) {
                    // Show player with single track
                    iframe.src = `https://open.spotify.com/embed/track/${spotifyTrackId}?utm_source=generator&theme=0`;
                    player.classList.remove('hidden');
                    btn.classList.add('playing');
                    
                    document.querySelector('.music-player-header span').textContent = 'üéµ Make It Rain Remix';
                } else {
                    // Hide player
                    player.classList.add('hidden');
                    iframe.src = '';
                    btn.classList.remove('playing');
                }
            });
            
            closeBtn.addEventListener('click', () => {
                player.classList.add('hidden');
                iframe.src = '';
                btn.classList.remove('playing');
            });
        });
    </script>

</body>
</html>
